{"ast":null,"code":"/*\nCopyright 2022 Adobe\nAll Rights Reserved.\n\nNOTICE: Adobe permits you to use, modify, and distribute this file in\naccordance with the terms of the Adobe license agreement accompanying\nit.\n*/\n\n/**\n * persistedQueries.js - provides a wrapper utility of persisted queries that are expected to be available on the AEM environment\n */\nimport { aemHeadlessClient, mapErrors } from \"./headlessClient\";\n/**\n * Queries a list of all Adventures using the persisted path \"wknd-shared/adventures-all\"\n * @returns {data, errors}\n */\n\nexport const getAllProducts = async function () {\n  return executePersistedQuery('mec/all-products');\n};\n/**\n * Custom hook that calls the 'mec/contact' persisted query.\n *\n * @returns an array of Team JSON objects, and array of errors\n */\n\nexport function useAllContact() {\n  const [teams, setTeams] = useState(null);\n  const [error, setError] = useState(null); // Use React useEffect to manage state changes\n\n  useEffect(() => {\n    async function fetchData() {\n      var _data$contactList;\n\n      // Call the AEM GraphQL persisted query named \"my-project/all-teams\"\n      const {\n        data,\n        err\n      } = await fetchPersistedQuery(\"mec/contact\"); // Sets the teams variable to the list of team JSON objects\n      // setTeams(data?.teamList?.items);\n\n      setTeams(data === null || data === void 0 ? void 0 : (_data$contactList = data.contactList) === null || _data$contactList === void 0 ? void 0 : _data$contactList.items); // Set any errors\n\n      setError(err);\n    } // Call the internal fetchData() as per React best practices\n\n\n    fetchData();\n  }, []); // Returns the teams and errors\n\n  return {\n    teams,\n    error\n  };\n}\n/**\n * Queries a single adventure based on its slug to a content fragment\n * uses persisted path 'wknd-shared/adventure-by-slug'\n * @param {*} adventurePath \n * @returns \n */\n\nexport const getProductBySlug = async function (adventureSlug) {\n  const queryVariables = {\n    'name': adventureSlug\n  };\n  return executePersistedQuery('mec/product-by-slug', queryVariables);\n};\n/**\n * Filters a list of adventures by activity \n * using the persisted path 'wknd-shared/adventures-by-activity'\n * @param {*} activityType \n * @returns \n */\n\nexport const getProductByCategory = async function (activityType) {\n  const queryVariables = {\n    'name': activityType\n  }; // expected query variables\n\n  return executePersistedQuery('mec/product-by-category', queryVariables);\n};\n/**\n * Uses the AEM Headless SDK to execute a query besed on a persistedQueryPath and optional query variables\n * @param {*} persistedQueryPath \n * @param {*} queryVariables \n * @returns \n */\n\nconst executePersistedQuery = async function (persistedQueryPath, queryVariables) {\n  let data;\n  let errors;\n\n  try {\n    // AEM GraphQL queries are asynchronous, either await their return or use Promise-based .then(..) { ... } syntax\n    const response = await aemHeadlessClient.runPersistedQuery(persistedQueryPath, queryVariables); // The GraphQL data is stored on the response's data field\n\n    data = response.data;\n    errors = response.errors ? mapErrors(response.errors) : undefined;\n  } catch (e) {\n    console.error(e.toJSON());\n    errors = e;\n  }\n\n  return {\n    data,\n    errors\n  };\n};","map":{"version":3,"names":["aemHeadlessClient","mapErrors","getAllProducts","executePersistedQuery","useAllContact","teams","setTeams","useState","error","setError","useEffect","fetchData","data","err","fetchPersistedQuery","contactList","items","getProductBySlug","adventureSlug","queryVariables","getProductByCategory","activityType","persistedQueryPath","errors","response","runPersistedQuery","undefined","e","console","toJSON"],"sources":["/Users/dkhetawat/Desktop/react-app-code/aem-guides-wknd-graphql-main/react-app/src/api/persistedQueries.js"],"sourcesContent":["/*\nCopyright 2022 Adobe\nAll Rights Reserved.\n\nNOTICE: Adobe permits you to use, modify, and distribute this file in\naccordance with the terms of the Adobe license agreement accompanying\nit.\n*/\n\n/**\n * persistedQueries.js - provides a wrapper utility of persisted queries that are expected to be available on the AEM environment\n */\nimport { aemHeadlessClient , mapErrors} from \"./headlessClient\";\n\n/**\n * Queries a list of all Adventures using the persisted path \"wknd-shared/adventures-all\"\n * @returns {data, errors}\n */\nexport const getAllProducts = async function() {\n    return executePersistedQuery('mec/all-products');\n}\n\n/**\n * Custom hook that calls the 'mec/contact' persisted query.\n *\n * @returns an array of Team JSON objects, and array of errors\n */\nexport function useAllContact() {\n  const [teams, setTeams] = useState(null);\n  const [error, setError] = useState(null);\n\n  // Use React useEffect to manage state changes\n  useEffect(() => {\n    async function fetchData() {\n      // Call the AEM GraphQL persisted query named \"my-project/all-teams\"\n      const { data, err } = await fetchPersistedQuery(\n        \"mec/contact\"\n      );\n      // Sets the teams variable to the list of team JSON objects\n     // setTeams(data?.teamList?.items);\n        setTeams(data?.contactList?.items);\n      // Set any errors\n      setError(err);\n    }\n    // Call the internal fetchData() as per React best practices\n    fetchData();\n  }, []);\n\n  // Returns the teams and errors\n  return { teams, error };\n}\n\n/**\n * Queries a single adventure based on its slug to a content fragment\n * uses persisted path 'wknd-shared/adventure-by-slug'\n * @param {*} adventurePath \n * @returns \n */\n export const getProductBySlug = async function(adventureSlug) {\n    const queryVariables = {'name': adventureSlug};\n    return executePersistedQuery('mec/product-by-slug', queryVariables);\n}\n\n/**\n * Filters a list of adventures by activity \n * using the persisted path 'wknd-shared/adventures-by-activity'\n * @param {*} activityType \n * @returns \n */\nexport const getProductByCategory = async function(activityType) {\n    const queryVariables = { 'name': activityType }; // expected query variables\n    return executePersistedQuery('mec/product-by-category', queryVariables);\n}\n\n\n/**\n * Uses the AEM Headless SDK to execute a query besed on a persistedQueryPath and optional query variables\n * @param {*} persistedQueryPath \n * @param {*} queryVariables \n * @returns \n */\n const executePersistedQuery = async function(persistedQueryPath, queryVariables) {\n\n    let data;\n    let errors;\n\n    try {\n        // AEM GraphQL queries are asynchronous, either await their return or use Promise-based .then(..) { ... } syntax\n        const response = await aemHeadlessClient.runPersistedQuery(persistedQueryPath, queryVariables);\n        // The GraphQL data is stored on the response's data field\n        data = response.data;\n        errors = response.errors ? mapErrors(response.errors) : undefined;\n    } catch (e) {\n        console.error(e.toJSON());\n        errors = e;\n    }\n\n    return {data, errors}; \n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAASA,iBAAT,EAA6BC,SAA7B,QAA6C,kBAA7C;AAEA;AACA;AACA;AACA;;AACA,OAAO,MAAMC,gBAAgB,GAAG,kBAAiB;EAC7C,OAAOC,qBAAqB,CAAC,kBAAD,CAA5B;AACH,CAFM;AAIP;AACA;AACA;AACA;AACA;;AACA,OAAO,SAASC,aAAT,GAAyB;EAC9B,MAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBC,QAAQ,CAAC,IAAD,CAAlC;EACA,MAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBF,QAAQ,CAAC,IAAD,CAAlC,CAF8B,CAI9B;;EACAG,SAAS,CAAC,MAAM;IACd,eAAeC,SAAf,GAA2B;MAAA;;MACzB;MACA,MAAM;QAAEC,IAAF;QAAQC;MAAR,IAAgB,MAAMC,mBAAmB,CAC7C,aAD6C,CAA/C,CAFyB,CAKzB;MACD;;MACGR,QAAQ,CAACM,IAAD,aAACA,IAAD,4CAACA,IAAI,CAAEG,WAAP,sDAAC,kBAAmBC,KAApB,CAAR,CAPuB,CAQzB;;MACAP,QAAQ,CAACI,GAAD,CAAR;IACD,CAXa,CAYd;;;IACAF,SAAS;EACV,CAdQ,EAcN,EAdM,CAAT,CAL8B,CAqB9B;;EACA,OAAO;IAAEN,KAAF;IAASG;EAAT,CAAP;AACD;AAED;AACA;AACA;AACA;AACA;AACA;;AACC,OAAO,MAAMS,kBAAkB,GAAG,gBAAeC,aAAf,EAA8B;EAC7D,MAAMC,cAAc,GAAG;IAAC,QAAQD;EAAT,CAAvB;EACA,OAAOf,qBAAqB,CAAC,qBAAD,EAAwBgB,cAAxB,CAA5B;AACH,CAHO;AAKR;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,MAAMC,uBAAuB,GAAG,gBAAeC,YAAf,EAA6B;EAChE,MAAMF,cAAc,GAAG;IAAE,QAAQE;EAAV,CAAvB,CADgE,CACf;;EACjD,OAAOlB,qBAAqB,CAAC,yBAAD,EAA4BgB,cAA5B,CAA5B;AACH,CAHM;AAMP;AACA;AACA;AACA;AACA;AACA;;AACC,MAAMhB,qBAAqB,GAAG,gBAAemB,kBAAf,EAAmCH,cAAnC,EAAmD;EAE9E,IAAIP,IAAJ;EACA,IAAIW,MAAJ;;EAEA,IAAI;IACA;IACA,MAAMC,QAAQ,GAAG,MAAMxB,iBAAiB,CAACyB,iBAAlB,CAAoCH,kBAApC,EAAwDH,cAAxD,CAAvB,CAFA,CAGA;;IACAP,IAAI,GAAGY,QAAQ,CAACZ,IAAhB;IACAW,MAAM,GAAGC,QAAQ,CAACD,MAAT,GAAkBtB,SAAS,CAACuB,QAAQ,CAACD,MAAV,CAA3B,GAA+CG,SAAxD;EACH,CAND,CAME,OAAOC,CAAP,EAAU;IACRC,OAAO,CAACpB,KAAR,CAAcmB,CAAC,CAACE,MAAF,EAAd;IACAN,MAAM,GAAGI,CAAT;EACH;;EAED,OAAO;IAACf,IAAD;IAAOW;EAAP,CAAP;AACH,CAjBA"},"metadata":{},"sourceType":"module"}